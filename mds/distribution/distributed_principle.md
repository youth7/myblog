# 1 概念

# 2 分布式系统原理

## 2.1 数据分布方式

### 2.1.1 哈希方式

### 2.1.2 按数据范围

### 2.1.3 按数据量

### 2.1.4 一致性哈希

### 2.1.5 副本与数据分布

**基本策略**：以机器为单位，若干机器互为副本，副本机器之间的数据完全相同

* 优点：简单
* 缺点：
    * 首先、使用该方式时，一旦出现副本数据丢失，需要恢复副本数据时效率不高
    * 再者、该种方式不利于提高系统扩展性
    * 最后、这种方式不利于系统容错

**优化策略**：数据段为单位作为副本

## 2.2 基本副本协议

## 2.2.2 primary-secondary协议

primary-secondary协议需要解决的4大问题：

* 数据更新流程
    * 1 数据更新都由primary节点协调完成。
    * 2 外部节点将更新操作发给primary节点
    * 3 primary节点进行并发控制即确定并发更新操作的先后顺序
    * 4 primary节点将更新操作发送给secondary节点
    * 5 primary根据secondary节点的完成情况决定更新是否成功并将结果返回外部节点
* 数据读取方式

    该方式通过降低系统的可用性来提高系统的一致性  
    Quorum机制
* Primary副本的确定和切换
* 数据同步（reconcile）

## 2.2.3 去中心化副本控制协议